<!DOCTYPE html>
<html lang="en" color-mode="light">

  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="keywords" content="" />
  <meta name="author" content="John Doe" />
  <meta name="description" content="" />
  
  
  <title>
    
      pre_iscc 
      
      
      |
    
     Hexo
  </title>

  
    <link rel="apple-touch-icon" href="/images/favicon.png">
    <link rel="icon" href="/images/favicon.png">
  

  <!-- Raleway-Font -->
  <link href="https://fonts.googleapis.com/css?family=Raleway&display=swap" rel="stylesheet">

  <!-- hexo site css -->
  
<link rel="stylesheet" href="/css/color-scheme.css">
<link rel="stylesheet" href="/css/base.css">
<link rel="stylesheet" href="/iconfont/iconfont.css">
<link rel="stylesheet" href="/css/github-markdown.css">
<link rel="stylesheet" href="/css/highlight.css">
<link rel="stylesheet" href="/css/comments.css">


  <!-- jquery3.3.1 -->
  <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>

  <!-- fancybox -->
  <link href="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.css" rel="stylesheet">
  <script async src="https://cdn.bootcss.com/fancybox/3.5.2/jquery.fancybox.min.js"></script>
  
<script src="/js/fancybox.js"></script>


  

  <script>
    var html = document.documentElement
    const colorMode = localStorage.getItem('color-mode')
    if (colorMode) {
      document.documentElement.setAttribute('color-mode', colorMode)
    }
  </script>

<meta name="generator" content="Hexo 6.0.0"></head>


  <body>
    <div id="app">
      <div class="header">
  <div class="avatar">
    <a href="/">
      <!-- 头像取消懒加载，添加no-lazy -->
      
        <img src="/images/avatar.png" alt="">
      
    </a>
    <div class="nickname"><a href="/">Oranges</a></div>
  </div>
  <div class="navbar">
    <ul>
      
        <li class="nav-item" data-path="/">
          <a href="/">Home</a>
        </li>
      
        <li class="nav-item" data-path="/archives/">
          <a href="/archives/">Archives</a>
        </li>
      
        <li class="nav-item" data-path="/tags/">
          <a href="/tags/">Tags</a>
        </li>
      
        <li class="nav-item" data-path="/friends/">
          <a href="/friends/">Friends</a>
        </li>
      
        <li class="nav-item" data-path="/about/">
          <a href="/about/">About</a>
        </li>
      
    </ul>
  </div>
</div>


<script src="/js/activeNav.js"></script>



      <div class="flex-container">
        <!-- 文章详情页，展示文章具体内容，url形式：https://yoursite/文章标题/ -->
<!-- 同时为「标签tag」，「朋友friend」，「分类categories」，「关于about」页面的承载页面，具体展示取决于page.type -->

<!-- LaTex Display -->
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<script>
MathJax = {
  tex: {
    inlineMath: [['$', '$'], ['\\(', '\\)']]
  }
};
</script>



  

  

  

  
  <!-- 文章内容页 url形式：https://yoursite/文章标题/ -->
  <div class="container post-details" id="post-details">
    <div class="post-content">
      <div class="post-title">pre_iscc</div>
      <div class="post-attach">
        <span class="post-pubtime">
          <i class="iconfont icon-updatetime" title="Update time"></i>
          2023-04-12 20:43:48
        </span>
        
      </div>
      <div class="markdown-body">
        <h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h2 id="1-奇特的信息"><a href="#1-奇特的信息" class="headerlink" title="1 奇特的信息"></a>1 奇特的信息</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">有人给你发了一串信息，你能解开吗？ Lw!</span><br><span class="line"></span><br><span class="line">Gyzvecy ke WvyVKT!</span><br><span class="line"></span><br><span class="line">W&#x27;zz by reso dsbdkwksky tzjq teo kly ujr. Teo keujr, gy joy dksurwmq bjdwv vorakeqojalr jmu wkd jaazwvjkwemd. Vorakeqojalr ljd j zemq lwdkeor, jzklesql gwkl kly juxymk et vecaskyod wk ljd qekkym oyjzzr vecazwvjkyu. Decy dwcazy ezu vwalyod joy kly Vjydjo vwalyo, kly Xwqymyoy vwalyo, kly dsbdkwkskwem vwalyo, glwvl wd klwd emy, jmu de em. Jzcedk jzz et klydy vwalyod joy yjdwzr boeiym keujr gwkl kly lyza et vecaskyod. Decy myg ymvorakwem cykleud joy JYD, kly vsooymk dkjmujou teo ymvorakwem, jzemq gwkl ODJ. Vorakeqojalr wd j xjdk twyzu jmu wd xyor wmkyoydkwmq klesql. De iwvi bjvi, oyju sa em decy veez vwalyod jmu ljxy tsm!</span><br><span class="line"></span><br><span class="line">El jmu teo reso oyveoud cr mjcy wd WvyVKT&#123;jzgjrd_zwdkym_ke_reso_dsbdkwksky_tzjqd&#125;.</span><br></pre></td></tr></table></figure>
<h3 id="解题过程"><a href="#解题过程" class="headerlink" title="解题过程"></a>解题过程</h3><p>题目给出了<strong>成篇成段的内容</strong>，基本思路为：<strong>词频分析、维吉尼亚、古典组合等等。</strong><br>首先尝试使用词频分析在线网站，便可直接得到结果：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hi! Welcome to IceCTF! I&#x27;ll be your substitute flag for the day. For today, we are studying basic cryptography and its applications. Cryptography has a long history, although with the advent of computers it has gotten really complicated. Some simple old ciphers are the Caesar cipher, the Vigenere cipher, the substitution cipher, which is this one, and so on. Almost all of these ciphers are easily broken today with the help of computers. Some new encryption methods are AES, the current standard for encryption, along with RSA. Cryptography is a vast field and is very interesting though. So kick back, read up on some cool ciphers and have fun! Oh and for your records my name is IceCTF&#123;always_listen_to_your_substitute_flags&#125;.</span><br></pre></td></tr></table></figure>
<h4 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h4><h5 id="（1）词频分析"><a href="#（1）词频分析" class="headerlink" title="（1）词频分析"></a>（1）词频分析</h5><p><a target="_blank" rel="noopener" href="https://quipqiup.com/">https://quipqiup.com/</a></p>
<h5 id="（2）爆破维吉尼亚"><a href="#（2）爆破维吉尼亚" class="headerlink" title="（2）爆破维吉尼亚"></a>（2）爆破维吉尼亚</h5><p><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">https://www.guballa.de/vigenere-solver</a></p>
<h5 id="（3）直接爆古典密码的Python库：ciphey"><a href="#（3）直接爆古典密码的Python库：ciphey" class="headerlink" title="（3）直接爆古典密码的Python库：ciphey"></a>（3）直接爆古典密码的Python库：ciphey</h5><p><strong>基本定义</strong></p>
<p>利用python环境使用自然语言处理和人工智能以及一些常识的全自动解密/解码/破解工具<br><strong>功能介绍</strong></p>
<p>不需要知道密文的加密方式和编码格式，只需要知道它是加密的，那么Ciphey就能解密，返回大部分密文的答案。<br>Ciphey支持6种基础加密【Caesar Cipher、Vigenere Cipher、Pig Latin、Reverse Cipher、Transposition Cipher、Binary Substitution Cipher（XY-Cipher）】、16种编码以及其他加密</p>
<h2 id="2海市蜃楼"><a href="#2海市蜃楼" class="headerlink" title="2海市蜃楼"></a>2海市蜃楼</h2><h3 id="解题过程-1"><a href="#解题过程-1" class="headerlink" title="解题过程"></a>解题过程</h3><p><img src="/2023/04/12/pre-iscc/1.png" alt></p>
<p>题目中的高频词是“海市蜃楼”，说明眼见未必为实。下载附件后，得到一个名为“zip”的文件：<br><img src="/2023/04/12/pre-iscc/2.png" alt></p>
<p>用记事本打开：</p>
<p><img src="/2023/04/12/pre-iscc/3.png" alt></p>
<p>发现PK打头，很可能为zip文件，用Winhex打开，发现zip压缩文件头为：504B0304，确认其为zip文件：</p>
<p><img src="/2023/04/12/pre-iscc/4.png" alt></p>
<p>直接改其后缀为zip并解压，得到了一个docx文件：</p>
<p><img src="/2023/04/12/pre-iscc/5.png" alt></p>
<p><img src="/2023/04/12/pre-iscc/6.png" alt></p>
<p>打开发现文件损坏，考虑是其他文件强制格式转换而来。再次用记事本打开发现PK打头，同理改为zip后缀，再次解压，得到一个文件夹，里面有很多xml文件：</p>
<p><img src="/2023/04/12/pre-iscc/7.png" alt></p>
<p>直接搜一下字符串ISCC：</p>
<p><img src="/2023/04/12/pre-iscc/8.png" alt></p>
<p>得到flag</p>
<h4 id="知识点-1"><a href="#知识点-1" class="headerlink" title="知识点"></a>知识点</h4><h5 id="常见文件头类型"><a href="#常见文件头类型" class="headerlink" title="常见文件头类型"></a>常见文件头类型</h5><p>一个文件若没有后缀名，无法判断是什么类型。这时候用Winhex打开，由文件头可以识别文件类型。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>文件类型</th>
<th>文件头（16进制）</th>
</tr>
</thead>
<tbody>
<tr>
<td>JPEG（jpg）</td>
<td>FFD8FFE1</td>
</tr>
<tr>
<td>PNG（png）</td>
<td>89504E47</td>
</tr>
<tr>
<td>GIF（gif）</td>
<td>47494638</td>
</tr>
<tr>
<td>TIFF（tif）</td>
<td>49492A00</td>
</tr>
<tr>
<td>Windows Bitmap（bmp）</td>
<td>424D</td>
</tr>
<tr>
<td>ZIP Archive（zip）</td>
<td>504B0304（ASCII码部分是PK，可以直接根据PK判断是zip文件，也可能是doc文件）</td>
</tr>
<tr>
<td>RAR Archive（rar）</td>
<td>52617221</td>
</tr>
<tr>
<td>Adobe Photoshop（psd）</td>
<td>38425053</td>
</tr>
<tr>
<td>Adobe Acrobat（pdf）</td>
<td>255044462D312E</td>
</tr>
<tr>
<td>MS Word/Excel（xls or doc）</td>
<td>D0CF11E0</td>
</tr>
<tr>
<td>Rich Text Format（rtf）</td>
<td>7B5C727466</td>
</tr>
<tr>
<td>XML（xml）</td>
<td>3C3F786D6C</td>
</tr>
<tr>
<td>HTML（html）</td>
<td>68746D6C3E</td>
</tr>
</tbody>
</table>
</div>
<h2 id="3美人计"><a href="#3美人计" class="headerlink" title="3美人计"></a>3美人计</h2><h3 id="解题过程-2"><a href="#解题过程-2" class="headerlink" title="解题过程"></a>解题过程</h3><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">美人说的话里有解题提示，但是美人的话不能全信。</span><br></pre></td></tr></table></figure>
<p>下载附件，得到一个rar压缩包，解压后得到一张jpg图像和一个docx文档。</p>
<p><img src="/2023/04/12/pre-iscc/10.png" alt></p>
<p>首先查看图片，是一张照片，没啥信息。习惯性查看图片属性：</p>
<p><img src="/2023/04/12/pre-iscc/11.png" alt></p>
<p>发现在主题描述中隐藏了解题信息：Try AES, and you will get the flag. ISCC2021</p>
<p>该内容大概就是所谓的“美人说的话”，依题意其中有解题提示，但是不全对。整合其中的关键内容：AES、ISCC2021，这两者为得到flag的关键。AES为加密方式，这种加密方式解密需要密码，而ISCC2021估计就是密码了。从题意中还知道其中有信息是错误的，什么信息有误？是AES加密？那么密钥是什么？ISCC2021？</p>
<p><strong>解题时不够敏感，没有将ISCC2021与密钥联系</strong></p>
<p>继续探索，查看docx文件。用word打开得到一个二维码：</p>
<p><img src="/2023/04/12/pre-iscc/12.png" style="zoom:80%;"></p>
<p>扫码得到一串字符：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1/Ka+sScszwQkwhO+VLiJwV/6IFg5W+TfNHGxG2qZsIr2iwMwb9X9Iu 3GuGWmPOtO27z8vNppD2D50fwsD+8VWhdtW9J4cewYivH/Z/7GoUvcJXJMrvf+vu +CBqWDGp6HWd0e5whGhuzlK0ZtBcDZdPDSIHA7+GuUlifp8PcFCtJPgiuk143REE +pKFiSJXolXLR1vJCdGY9w5mXFbiWPrb2U7r/v5noP8=</span><br></pre></td></tr></table></figure>
<p>发现其结尾有一个等号，且由大小写和数字组成，猜测其为base64。使用base64在线解码（<a target="_blank" rel="noopener" href="https://base64.us/）后得到：">https://base64.us/）后得到：</a></p>
<p><img src="/2023/04/12/pre-iscc/13.png" alt></p>
<p>不行。但是解密后的结果中出现了Salted__（这个是通过openssl加密如果不带base64就会出现Salted字段打头）</p>
<p>想到了提示，尝试AES解密（<a target="_blank" rel="noopener" href="http://www.jsons.cn/aesencrypt/）得到：">http://www.jsons.cn/aesencrypt/）得到：</a></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1/F/2UY3zj2zA0HjR54wZUR3lD9wApEV/mmq2KZPM3tnX6a03zkDKQZ</span><br><span class="line"></span><br><span class="line">whCKH+Huk5sg2mMUVjqXloZ7zmGCsFtmva7gxWds3E0ctVDiFX86HB4fI447WjEc</span><br><span class="line"></span><br><span class="line">/T3VEOgJmcSXXFyeTi176g==</span><br></pre></td></tr></table></figure>
<p>相比起来，结构类似，但是由四行变三行，却不知道该怎么继续下去。<strong>没有想到要进行三次解密</strong></p>
<p>再次进行AES解密，得到两行：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX18zMFzxz78oV5UqqkVZr1DA+UL1/BML0rrGwdSTLkN38XX0yIY7rL55</span><br><span class="line"></span><br><span class="line">2TrZ66Lki+nOP/mENZmzOQ==</span><br></pre></td></tr></table></figure>
<p>再解密：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y0u_h@ve_fal1en_intO_tHe_tr@p_0f_tHe_be@uty_!</span><br></pre></td></tr></table></figure>
<p>提示已经调入美丽的陷阱，和“但是美人的话不能全信”呼应。<strong>或许加密方式并非为AES</strong></p>
<p>继续探索……</p>
<p>用记事本打开该docx文件，发现其以PK打头：</p>
<p><img src="/2023/04/12/pre-iscc/14.png" style="zoom:80%;"></p>
<p>大概率为zip文件，用winhex打开：</p>
<p><img src="/2023/04/12/pre-iscc/15.png" alt></p>
<p>文件头为504B0304，故将其后缀改为zip后解压缩得到一个文件夹：</p>
<p><img src="/2023/04/12/pre-iscc/16.png" alt></p>
<p>直接搜索关键词ISCC无果。一个一个文件打开翻翻，在word\media中又发现两个二维码：</p>
<p><img src="/2023/04/12/pre-iscc/17.png" alt></p>
<p>扫第一个二维码：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX19eOY/pDh8+vPAcvfkLi1XLUneVzjLLOMul53sKK8UpobdCOiPIv4KE</span><br></pre></td></tr></table></figure>
<p>第二个：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U2FsdGVkX1/Ka+sScszwQkwhO+VLiJwV/6IFg5W+TfNHGxG2qZsIr2iwMwb9X9Iu 3GuGWmPOtO27z8vNppD2D50fwsD+8VWhdtW9J4cewYivH/Z/7GoUvcJXJMrvf+vu +CBqWDGp6HWd0e5whGhuzlK0ZtBcDZdPDSIHA7+GuUlifp8PcFCtJPgiuk143REE +pKFiSJXolXLR1vJCdGY9w5mXFbiWPrb2U7r/v5noP8=</span><br></pre></td></tr></table></figure>
<p>第二个二维码扫描结果和之前的二维码结果一样。</p>
<p>对第一个结果进行AES解密，果然解不出来。尝试用DES解密，得到flag：</p>
<p><img src="/2023/04/12/pre-iscc/18.jpg" alt></p>
<h4 id="知识点-2"><a href="#知识点-2" class="headerlink" title="知识点"></a>知识点</h4><h5 id="盐（salt-value）"><a href="#盐（salt-value）" class="headerlink" title="盐（salt value）"></a>盐（salt value）</h5><p><strong>基本定义</strong></p>
<p>在密码学中，通过在密码任意固定位置插入特定字符串，让散列后的结果和使用原始密码的散列结果不相同，</p>
<p>这个在散列中加入字符串的方式称为<strong>“加盐”</strong>。而<strong>“盐值”</strong>是一组随机的字符串，被称为“Salt”，由系统随机生成。</p>
<p><strong>作用</strong></p>
<p>让加盐后的散列结果和没有加盐的结果不相同，增加安全性，是加密过程中的加固手段。</p>
<p><strong>应用</strong></p>
<p>base64字符串解密后，发现其开头为“Salted__”字样（加盐了），考虑为<strong>AES、DES、3DES</strong>（会有加盐值的操作）（这些加密最后得到的是字节值[b’xxxx’]，由于字节值不方便传输，最后会采用base64编码；RSA的证书一般也是base64编码）。其中，在这个前缀后面的八个字符就是salt。对应的，Base64前缀若出现“U2FsdGVkX1”，就说明其格式遵循OpenSSL的加密定义。（“U2FsdGVkX1”使用Base64解密可以得到“Salted”）</p>
<h2 id="4我的折扣是多少"><a href="#4我的折扣是多少" class="headerlink" title="4我的折扣是多少"></a>4我的折扣是多少</h2><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">小c同学去参加音乐会，在官网买票时发现了有提示消息，提供给的有“give_me_discount”的压缩包，好奇的小c下载下来，但却无从下手，为了节省零花钱，你能帮帮他吗？</span><br></pre></td></tr></table></figure>
<h3 id="解题过程-3"><a href="#解题过程-3" class="headerlink" title="解题过程"></a>解题过程</h3><p>下载附件得到压缩包，解压后得到三个文件：</p>
<p><img src="/2023/04/12/pre-iscc/20.png" alt></p>
<p>想继续解压me.zip，发现需要密码，即我们需要做的是破解出压缩包的密码：</p>
<p><img src="/2023/04/12/pre-iscc/21.png" alt></p>
<p>另外给了一个MP3声音和一个exe程序。</p>
<p>先听下音频是一段旋律“I am sitting in the morning at the……”，不知道入手点在哪。接着运行程序give.exe，打开后一闪而过，截个图查看：</p>
<p><img src="/2023/04/12/pre-iscc/22.png" alt></p>
<p>找到了入手点：pass1{\u006b \u0072 \u0077}</p>
<p><strong>根据pass1这个提示可以知道这只是密码的一部分，有pass1，应该想到有pass2</strong></p>
<p>发现其为Unicode码的字符。转码试试：</p>
<p><img src="/2023/04/12/pre-iscc/23.png" alt></p>
<p>看起来不像是压缩包的密码……试试果然不是。那krw又是什么意思呢？一时不知道如何进行下去。</p>
<p><strong>用010Editor或winhex或者记事本打开查看压缩包</strong></p>
<p><img src="/2023/04/12/pre-iscc/24.png" alt></p>
<p>发现一段字符：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cGFzczJ7Z2NjNjY2fQ==</span><br></pre></td></tr></table></figure>
<p>以==结尾像是base64，解码（<a target="_blank" rel="noopener" href="https://base64.us/）：">https://base64.us/）：</a></p>
<p><img src="/2023/04/12/pre-iscc/25.png" alt></p>
<p>得到pass2，<strong>把pass1和pass2拼在一起</strong>试试看是否为压缩包密码</p>
<p><img src="/2023/04/12/pre-iscc/26.png" alt></p>
<p>解压缩后得到一个名为what’s_mean.txt文本文档：</p>
<p><img src="/2023/04/12/pre-iscc/27.png" alt></p>
<p>仍像是base64编码：</p>
<p><img src="/2023/04/12/pre-iscc/28.png" alt></p>
<p>不像是flag，难道是歌名？也不是，又不知该如何继续了。梳理一下题目给出的信息，give.exe用于提供pass1，me.zip藏有base64提供pass2，组合起来解开压缩包，得到“youfoundme？”，正如文件名”这到底意味着什么？”不是flag，或许可能为密码。</p>
<p>突然反应过来，题目便是提示，即<strong>按照give_me_discount的顺序进行解密</strong>。</p>
<p>现在还有音频文件无从下手。自己本身不够敏感，其实从下载附件的三个文件中，就可以看出这题后面会涉及<strong>音频的隐写</strong>，那么“youfoundme？”便可能为MP3文件的解隐写密码。</p>
<p>接下来对音频解隐写进行尝试，使用<strong>MP3Stego</strong>（是一种常用于从mp3文件中提取flag的工具）分析mp3：</p>
<p><img src="/2023/04/12/pre-iscc/32.png" alt></p>
<p>在分析之前需要把待分析的mp3文件（discount.mp3）拖到Decode.exe所在目录中，接着把Decode.exe拖到命令行中，再输入：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-X -P youfoundme? discount.mp3</span><br></pre></td></tr></table></figure>
<p>执行解析完毕后会在该目录下生成一个discount.mp3.txt文件：</p>
<p><img src="/2023/04/12/pre-iscc/33.png" alt></p>
<p>打开得到加密后的flag：</p>
<p><img src="/2023/04/12/pre-iscc/34.png" alt></p>
<p>进行base32解码：</p>
<p><img src="/2023/04/12/pre-iscc/35.png" alt></p>
<p>得到flag：ISCC{Yourdiscount2.15}</p>
<h3 id="整理复盘"><a href="#整理复盘" class="headerlink" title="整理复盘"></a>整理复盘</h3><p>1.下载附件后出现了音频文件，可能会涉及到音频的隐写，也可能是摩斯密码（特征明显）；</p>
<p>2.按照附件名：give_me_discount的顺序进行解密；</p>
<p>​    2.1根据give.exe解码出的结果pass1这个提示可知，该部分仅仅是密码的前一部分；</p>
<p>​    2.2用010editor（记事本、winhex等）打开me.zip，解码后得到pass2；</p>
<p>​    2.3组合起来便可以用完整的密码后便可解开压缩文件me.zip;</p>
<p>​    2.4解压后得到MP3文件的解隐写密码；</p>
<p>3.有了另一个密码，便可以合理怀疑音频文件中藏了另外的文件。使用MP3Stego工具进行解隐写（这样便用上了me.zip解压出来的密码）。</p>
<h4 id="知识点-3"><a href="#知识点-3" class="headerlink" title="知识点"></a>知识点</h4><h5 id="（1）Unicode码"><a href="#（1）Unicode码" class="headerlink" title="（1）Unicode码"></a>（1）Unicode码</h5><p>\u开头的是一个Unicode码的字符，每一个’\u0000’都代表了一个空格。</p>
<p>在表示一个Unicode的字符时，通常会用“U+”然后紧接着一组十六进制的数字来表示这一个字符。在 基本多文种平面里的所有字符，要用四位十六进制数。</p>
<p>在线转码网站：<a target="_blank" rel="noopener" href="http://www.jsons.cn/unicode/">http://www.jsons.cn/unicode/</a></p>
<h5 id="（2）010Editor"><a href="#（2）010Editor" class="headerlink" title="（2）010Editor"></a>（2）010Editor</h5><p><strong>原理：</strong></p>
<p>010edit本身为hex编辑器，用于查看编辑二进制数据</p>
<p><strong>用途：</strong></p>
<p>查看</p>
<p>A压缩包【熟悉文件结构，找到对应的位置进行修改。比如压缩包伪加密（标志位的数据进行了设置），可以通过010editor修改标志位。】</p>
<p>B二进制文件（exe、dll、msi等）【可以看到hex数据（hex表示二进制比较方便），也就是二进制数据】</p>
<p>C没有后缀名的文件</p>
<h5 id="（3）MP3Stego"><a href="#（3）MP3Stego" class="headerlink" title="（3）MP3Stego"></a>（3）MP3Stego</h5><p><strong>简介：</strong></p>
<p>最著名的隐写工具MP3Stego用于支持常见的压缩音频文件（如MP3或AAC）的数据嵌入。</p>
<p>它采用一种特殊的量化方法，并将数据隐藏在MP3文件的奇偶校验块中。MP3编码器将wav文件和一个要隐藏的载荷文件作为输入，生成一个新的mp3文件。这种方法最显著的局限性在于载荷文件不能太大。</p>
<p><strong>下载：</strong></p>
<p>官网<a target="_blank" rel="noopener" href="https://www">https://www</a>. petitcolas. net/steganography/mp3stego/</p>
<p><strong>命令：</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-X               提取隐藏数据</span><br><span class="line">-P &lt;text&gt;        用密码用于嵌入</span><br><span class="line">-A               编写AIFF输出PCM声音文件</span><br><span class="line">-s &lt;sb&gt;          仅在此SB（仅调试）</span><br><span class="line">inputBS          编码音频的输入位</span><br><span class="line">outPCM           输出PCM声音文件（DFLT输入+.AIF | .pcm）</span><br><span class="line">outhidden        输出隐藏的文本文件（dflt inputbs+.txt）</span><br></pre></td></tr></table></figure>
<p><strong>使用方法：</strong></p>
<p>直接将.mp3文件复制进MP3Stego_1_1_19\MP3Stego目录 （即MP3Stego所在的目录）：</p>
<p><img src="/2023/04/12/pre-iscc/29.png" alt></p>
<p><img src="/2023/04/12/pre-iscc/30.png" alt></p>
<p>然后在该目录的路径框里输入cmd，之后回车便可以在该路径下打开cmd</p>
<p><img src="/2023/04/12/pre-iscc/31.png" alt></p>
<p>在输入命令分析之前需要把待分析的.mp3文件拖到Decode.exe所在目录中，接着把Decode.exe拖到命令行中，</p>
<p>输入命令，格式如：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-X -P password music.mp3</span><br></pre></td></tr></table></figure>
<p>其中，命令中-X是用于获取隐藏的文件，-P后面写密码。</p>
<p>回车可以正常解密，解密完成后在该路径下面多出两个文件，分别是：music.mp3.pcm和music.mp3.txt</p>
<p><strong>注意：</strong></p>
<p>要在路径MP3Stego_1_1_19\MP3Stego下使用decode -X -P password music.mp3 </p>
<p>不然有可能会出现如下报错信息：</p>
<p><img src="/2023/04/12/pre-iscc/36.png" alt></p>
<h5 id="（4）Base编码系列"><a href="#（4）Base编码系列" class="headerlink" title="（4）Base编码系列"></a>（4）Base编码系列</h5><p><strong>特征判断：</strong></p>
<p>它们之间最明显的区别就是使用了不同数量的可打印字符对任意字节数据进行编码</p>
<p>Base16【16进制转ASCII问题】<strong>结尾没有等号，数字要多于字母</strong></p>
<p>特征：密文由16个可打印字符（A-F，0-9）组成</p>
<p>Base32<strong>字母要多于数字，明文数量超过10个，结尾可能会有很多等号</strong></p>
<p>特征：密文由32个字符（A-Z，2-7）组成，末尾可能会有‘=’，但是最多有6个。</p>
<p>Base64<strong>一般情况下，结尾都会有1或者2个等号，明文很少的时候可能没有</strong></p>
<p>特征：密文由64个可打印字符（A-Z，a-z，0-9，+，/）组成，如果字符不足则会用“=”补齐</p>
<p><strong>在线工具：</strong></p>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/base.php（针对Base64、Base32、Base16）">https://www.qqxiuzi.cn/bianma/base.php（针对Base64、Base32、Base16）</a></p>
<h5 id="（5）一些常见编码与加密算法的特征"><a href="#（5）一些常见编码与加密算法的特征" class="headerlink" title="（5）一些常见编码与加密算法的特征"></a>（5）一些常见编码与加密算法的特征</h5><p>编码：Base系列、Unicode、URL(Hex)等</p>
<p>加密算法：MD5等</p>
<p>古典密码：凯撒密码、栅栏密码、猪圈密码、摩斯密码、培根密码、维吉尼亚密码、与佛论禅、当铺密码等</p>
<p>发现一篇挺好的文章，总结了各种的判断特征：<a target="_blank" rel="noopener" href="https://baijiahao.baidu.com/s?id=1721920305612879489&amp;wfr=spider&amp;for=pc">https://baijiahao.baidu.com/s?id=1721920305612879489&amp;wfr=spider&amp;for=pc</a></p>
<h2 id="一些总结"><a href="#一些总结" class="headerlink" title="一些总结"></a>一些总结</h2><p>Misc题目包括：编码、图片隐写、音频隐写、压缩包、流量分析等等。出题常将以上类型结合在一起。</p>
<h3 id="图片隐写"><a href="#图片隐写" class="headerlink" title="图片隐写"></a>图片隐写</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_51684866/article/details/120602533">https://blog.csdn.net/m0_51684866/article/details/120602533</a></p>
<h4 id="（1）直接查看图片数据"><a href="#（1）直接查看图片数据" class="headerlink" title="（1）直接查看图片数据"></a>（1）直接查看图片数据</h4><p>利用（记事本、010Editor、winhex等工具）打开图片，搜索flag或一些编码。</p>
<h4 id="（2）查看图片属性"><a href="#（2）查看图片属性" class="headerlink" title="（2）查看图片属性"></a>（2）查看图片属性</h4><p>一般不把flag放在属性中，但是属性有时会提供解题信息，比如压缩包密码等。</p>
<h4 id="（3）修改图片格式、高度，将文本转换为图片"><a href="#（3）修改图片格式、高度，将文本转换为图片" class="headerlink" title="（3）修改图片格式、高度，将文本转换为图片"></a>（3）修改图片格式、高度，将文本转换为图片</h4><p>若用010Editor查看图片时发现图片格式与题目给出的格式不同，进行修改；</p>
<p>若发现图片有明显的缺失，放到010中修改图片高度；</p>
<p>若给出记事本文档，通常打开可以明显看到图片原先格式，进行修改。</p>
<h4 id="（4）LSB隐写"><a href="#（4）LSB隐写" class="headerlink" title="（4）LSB隐写"></a>（4）LSB隐写</h4><p><strong>定义：</strong></p>
<p>LSB（least significant bit，最低有效位）隐写就是出题者将flag隐藏到图片的颜色通道中，实用算法简单，能存储的信息量也大，是一种常见的信息隐藏方法。</p>
<p>修改最低有效位信息的算法称为LSB加密算法</p>
<p>提取最低有效位信息的算法称为LSB解密算法</p>
<p><strong>原理：</strong></p>
<p>LSD隐写就是修改RGB颜色分量的最低二进制位也就是最低有效位（LSB），而人眼不会注意到前后的变化，每个像素可以携带3比特的信息。</p>
<p>例子如下，其中十进制的235表示的是绿色，可以通过修改最低位中的信息，实现信息的隐写。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>Color</th>
<th>Base 10</th>
<th>Binary</th>
<th>Change</th>
</tr>
</thead>
<tbody>
<tr>
<td>Green</td>
<td>238</td>
<td>11101110</td>
<td>+3</td>
</tr>
<tr>
<td>Green</td>
<td>235</td>
<td>11101011</td>
<td>（base）</td>
</tr>
<tr>
<td>Green</td>
<td>232</td>
<td>11101000</td>
<td>-3</td>
</tr>
</tbody>
</table>
</div>
<p><strong>工具：</strong></p>
<p>Selgsolve（将图片的各个通道都分离出来，可以查看每个通道的数据，逐个分析）</p>
<p>zsteg（安装在kali中，可以自动分析图片，将隐藏的信息爆出来）【使用：终端输入zsteg，拖入图片；其中zsteg -a可以分析每个通道的数据，但一般没必要】</p>

      </div>
      
        <div class="prev-or-next">
          <div class="post-foot-next">
            
              <a href="/2023/03/30/%E6%BC%8F%E6%B4%9Epart/" target="_self">
                <i class="iconfont icon-chevronleft"></i>
                <span>Prev</span>
              </a>
            
          </div>
          <div class="post-attach">
            <span class="post-pubtime">
              <i class="iconfont icon-updatetime" title="Update time"></i>
              2023-04-12 20:43:48
            </span>
            
          </div>
          <div class="post-foot-prev">
            
              <a href="/2023/06/13/setup/" target="_self">
                <span>Next</span>
                <i class="iconfont icon-chevronright"></i>
              </a>
            
          </div>
        </div>
      
    </div>
    
  <div id="btn-catalog" class="btn-catalog">
    <i class="iconfont icon-catalog"></i>
  </div>
  <div class="post-catalog hidden" id="catalog">
    <div class="title">Contents</div>
    <div class="catalog-content">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#misc"><span class="toc-text">misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%A5%87%E7%89%B9%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="toc-text">1 奇特的信息</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B"><span class="toc-text">解题过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="toc-text">知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E8%AF%8D%E9%A2%91%E5%88%86%E6%9E%90"><span class="toc-text">（1）词频分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E7%88%86%E7%A0%B4%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A"><span class="toc-text">（2）爆破维吉尼亚</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E7%9B%B4%E6%8E%A5%E7%88%86%E5%8F%A4%E5%85%B8%E5%AF%86%E7%A0%81%E7%9A%84Python%E5%BA%93%EF%BC%9Aciphey"><span class="toc-text">（3）直接爆古典密码的Python库：ciphey</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E6%B5%B7%E5%B8%82%E8%9C%83%E6%A5%BC"><span class="toc-text">2海市蜃楼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B-1"><span class="toc-text">解题过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-1"><span class="toc-text">知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E5%A4%B4%E7%B1%BB%E5%9E%8B"><span class="toc-text">常见文件头类型</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E7%BE%8E%E4%BA%BA%E8%AE%A1"><span class="toc-text">3美人计</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B-2"><span class="toc-text">解题过程</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-2"><span class="toc-text">知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%90%EF%BC%88salt-value%EF%BC%89"><span class="toc-text">盐（salt value）</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E6%88%91%E7%9A%84%E6%8A%98%E6%89%A3%E6%98%AF%E5%A4%9A%E5%B0%91"><span class="toc-text">4我的折扣是多少</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B-3"><span class="toc-text">解题过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E7%90%86%E5%A4%8D%E7%9B%98"><span class="toc-text">整理复盘</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9-3"><span class="toc-text">知识点</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%881%EF%BC%89Unicode%E7%A0%81"><span class="toc-text">（1）Unicode码</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%882%EF%BC%89010Editor"><span class="toc-text">（2）010Editor</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%883%EF%BC%89MP3Stego"><span class="toc-text">（3）MP3Stego</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%884%EF%BC%89Base%E7%BC%96%E7%A0%81%E7%B3%BB%E5%88%97"><span class="toc-text">（4）Base编码系列</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%EF%BC%885%EF%BC%89%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%BC%96%E7%A0%81%E4%B8%8E%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95%E7%9A%84%E7%89%B9%E5%BE%81"><span class="toc-text">（5）一些常见编码与加密算法的特征</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E6%80%BB%E7%BB%93"><span class="toc-text">一些总结</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99"><span class="toc-text">图片隐写</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%881%EF%BC%89%E7%9B%B4%E6%8E%A5%E6%9F%A5%E7%9C%8B%E5%9B%BE%E7%89%87%E6%95%B0%E6%8D%AE"><span class="toc-text">（1）直接查看图片数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%882%EF%BC%89%E6%9F%A5%E7%9C%8B%E5%9B%BE%E7%89%87%E5%B1%9E%E6%80%A7"><span class="toc-text">（2）查看图片属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%883%EF%BC%89%E4%BF%AE%E6%94%B9%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F%E3%80%81%E9%AB%98%E5%BA%A6%EF%BC%8C%E5%B0%86%E6%96%87%E6%9C%AC%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%9B%BE%E7%89%87"><span class="toc-text">（3）修改图片格式、高度，将文本转换为图片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%EF%BC%884%EF%BC%89LSB%E9%9A%90%E5%86%99"><span class="toc-text">（4）LSB隐写</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
  </div>

  
<script src="/js/catalog.js"></script>




    
      <div class="comments-container">
        







      </div>
    
  </div>


        <div class="footer">
  <div class="social">
    <ul>
      
        <li>
          <a title="github" target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">
            <i class="iconfont icon-github"></i>
          </a>
        </li>
      
        <li>
          <a title="email" href="">
            <i class="iconfont icon-envelope"></i>
          </a>
        </li>
      
        <li>
          <a title="facebook" href="">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        </li>
      
        <li>
          <a title="twitter" href="">
            <i class="iconfont icon-twitter"></i>
          </a>
        </li>
      
        <li>
          <a title="wechat" href="">
            <i class="iconfont icon-wechat"></i>
          </a>
        </li>
      
        <li>
          <a title="weibo" href="">
            <i class="iconfont icon-weibo"></i>
          </a>
        </li>
      
        <li>
          <a title="rss" href="/atom.xml">
            <i class="iconfont icon-rss"></i>
          </a>
        </li>
      
    </ul>
  </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Copyright © Oranges 2021</a>
        
    </div>
  
    <div class="footer-more">
      
        <a target="_blank" rel="noopener" href="https://github.com/zchengsite/hexo-theme-oranges">Theme by Oranges | Powered by Hexo</a>
        
    </div>
  
</div>

      </div>

      <div class="tools-bar">
        <div class="back-to-top tools-bar-item hidden">
  <a href="javascript: void(0)">
    <i class="iconfont icon-chevronup"></i>
  </a>
</div>


<script src="/js/backtotop.js"></script>



        
  <div class="search-icon tools-bar-item" id="search-icon">
    <a href="javascript: void(0)">
      <i class="iconfont icon-search"></i>
    </a>
  </div>

  <div class="search-overlay hidden">
    <div class="search-content" tabindex="0">
      <div class="search-title">
        <span class="search-icon-input">
          <a href="javascript: void(0)">
            <i class="iconfont icon-search"></i>
          </a>
        </span>
        
          <input type="text" class="search-input" id="search-input" placeholder="Search...">
        
        <span class="search-close-icon" id="search-close-icon">
          <a href="javascript: void(0)">
            <i class="iconfont icon-close"></i>
          </a>
        </span>
      </div>
      <div class="search-result" id="search-result"></div>
    </div>
  </div>

  <script type="text/javascript">
    var inputArea = document.querySelector("#search-input")
    var searchOverlayArea = document.querySelector(".search-overlay")

    inputArea.onclick = function() {
      getSearchFile()
      this.onclick = null
    }

    inputArea.onkeydown = function() {
      if(event.keyCode == 13)
        return false
    }

    function openOrHideSearchContent() {
      let isHidden = searchOverlayArea.classList.contains('hidden')
      if (isHidden) {
        searchOverlayArea.classList.remove('hidden')
        document.body.classList.add('hidden')
        // inputArea.focus()
      } else {
        searchOverlayArea.classList.add('hidden')
        document.body.classList.remove('hidden')
      }
    }

    function blurSearchContent(e) {
      if (e.target === searchOverlayArea) {
        openOrHideSearchContent()
      }
    }

    document.querySelector("#search-icon").addEventListener("click", openOrHideSearchContent, false)
    document.querySelector("#search-close-icon").addEventListener("click", openOrHideSearchContent, false)
    searchOverlayArea.addEventListener("click", blurSearchContent, false)

    var searchFunc = function (path, search_id, content_id) {
      'use strict';
      var $input = document.getElementById(search_id);
      var $resultContent = document.getElementById(content_id);
      $resultContent.innerHTML = "<ul><span class='local-search-empty'>First search, index file loading, please wait...<span></ul>";
      $.ajax({
        // 0x01. load xml file
        url: path,
        dataType: "xml",
        success: function (xmlResponse) {
          // 0x02. parse xml file
          var datas = $("entry", xmlResponse).map(function () {
            return {
              title: $("title", this).text(),
              content: $("content", this).text(),
              url: $("url", this).text()
            };
          }).get();
          $resultContent.innerHTML = "";

          $input.addEventListener('input', function () {
            // 0x03. parse query to keywords list
            var str = '<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length <= 0) {
              return;
            }
            // 0x04. perform local searching
            datas.forEach(function (data) {
              var isMatch = true;
              var content_index = [];
              if (!data.title || data.title.trim() === '') {
                data.title = "Untitled";
              }
              var orig_data_title = data.title.trim();
              var data_title = orig_data_title.toLowerCase();
              var orig_data_content = data.content.trim().replace(/<[^>]+>/g, "");
              var data_content = orig_data_content.toLowerCase();
              var data_url = data.url;
              var index_title = -1;
              var index_content = -1;
              var first_occur = -1;
              // only match artiles with not empty contents
              if (data_content !== '') {
                keywords.forEach(function (keyword, i) {
                  index_title = data_title.indexOf(keyword);
                  index_content = data_content.indexOf(keyword);

                  if (index_title < 0 && index_content < 0) {
                    isMatch = false;
                  } else {
                    if (index_content < 0) {
                      index_content = 0;
                    }
                    if (i == 0) {
                      first_occur = index_content;
                    }
                    // content_index.push({index_content:index_content, keyword_len:keyword_len});
                  }
                });
              } else {
                isMatch = false;
              }
              // 0x05. show search results
              if (isMatch) {
                str += "<li><a href='" + data_url + "' class='search-result-title'>" + orig_data_title + "</a>";
                var content = orig_data_content;
                if (first_occur >= 0) {
                  // cut out 100 characters
                  var start = first_occur - 20;
                  var end = first_occur + 80;

                  if (start < 0) {
                    start = 0;
                  }

                  if (start == 0) {
                    end = 100;
                  }

                  if (end > content.length) {
                    end = content.length;
                  }

                  var match_content = content.substr(start, end);

                  // highlight all keywords
                  keywords.forEach(function (keyword) {
                    var regS = new RegExp(keyword, "gi");
                    match_content = match_content.replace(regS, "<span class=\"search-keyword\">" + keyword + "</span>");
                  });

                  str += "<p class=\"search-result-abstract\">" + match_content + "...</p>"
                }
                str += "</li>";
              }
            });
            str += "</ul>";
            if (str.indexOf('<li>') === -1) {
              return $resultContent.innerHTML = "<ul><span class='local-search-empty'>No result<span></ul>";
            }
            $resultContent.innerHTML = str;
          });
        },
        error: function(xhr, status, error) {
          $resultContent.innerHTML = ""
          if (xhr.status === 404) {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The search.xml file was not found, please refer to：<a href='https://github.com/zchengsite/hexo-theme-oranges#configuration' target='_black'>configuration</a><span></ul>";
          } else {
            $resultContent.innerHTML = "<ul><span class='local-search-empty'>The request failed, Try to refresh the page or try again later.<span></ul>";
          }
        }
      });
      $(document).on('click', '#search-close-icon', function() {
        $('#search-input').val('');
        $('#search-result').html('');
      });
    }

    var getSearchFile = function() {
        var path = "/search.xml";
        searchFunc(path, 'search-input', 'search-result');
    }
  </script>




        
  <div class="tools-bar-item theme-icon" id="switch-color-scheme">
    <a href="javascript: void(0)">
      <i id="theme-icon" class="iconfont icon-moon"></i>
    </a>
  </div>

  
<script src="/js/colorscheme.js"></script>





        
  
    <div class="share-icon tools-bar-item">
      <a href="javascript: void(0)" id="share-icon">
        <i class="iconfont iconshare"></i>
      </a>
      <div class="share-content hidden">
        
          <a class="share-item" href="https://twitter.com/intent/tweet?text=' + pre_iscc + '&url=' + http%3A%2F%2Fyy-ll.github.io%2F2023%2F04%2F12%2Fpre-iscc%2F + '" target="_blank" title="Twitter">
            <i class="iconfont icon-twitter"></i>
          </a>
        
        
          <a class="share-item" href="https://www.facebook.com/sharer.php?u=http://yy-ll.github.io/2023/04/12/pre-iscc/" target="_blank" title="Facebook">
            <i class="iconfont icon-facebooksquare"></i>
          </a>
        
      </div>
    </div>
  
  
<script src="/js/shares.js"></script>



      </div>
    </div>
  </body>
</html>
